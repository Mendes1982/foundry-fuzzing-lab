{"abi":[{"type":"fallback","stateMutability":"payable"},{"type":"receive","stateMutability":"payable"},{"type":"function","name":"balances","inputs":[{"name":"","type":"address","internalType":"address"}],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"deposit","inputs":[],"outputs":[],"stateMutability":"payable"},{"type":"function","name":"getBalance","inputs":[{"name":"user","type":"address","internalType":"address"}],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"getContractBalance","inputs":[],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"withdraw","inputs":[],"outputs":[],"stateMutability":"nonpayable"},{"type":"event","name":"Deposit","inputs":[{"name":"user","type":"address","indexed":true,"internalType":"address"},{"name":"amount","type":"uint256","indexed":false,"internalType":"uint256"}],"anonymous":false},{"type":"event","name":"Withdrawal","inputs":[{"name":"user","type":"address","indexed":true,"internalType":"address"},{"name":"amount","type":"uint256","indexed":false,"internalType":"uint256"}],"anonymous":false}],"bytecode":{"object":"0x6080604052348015600e575f5ffd5b5061033b8061001c5f395ff3fe608060405260043610610049575f3560e01c806327e235e31461004b5780633ccfd60b146100885780636f9fb98a1461009c578063d0e30db0146100ae578063f8b2cb4f146100b6575b005b348015610056575f5ffd5b506100766100653660046102b3565b5f6020819052908152604090205481565b60405190815260200160405180910390f35b348015610093575f5ffd5b506100496100ea565b3480156100a7575f5ffd5b5047610076565b610049610212565b3480156100c1575f5ffd5b506100766100d03660046102b3565b6001600160a01b03165f9081526020819052604090205490565b335f90815260208190526040902054806101445760405162461bcd60e51b81526020600482015260166024820152754e6f2062616c616e636520746f20776974686472617760501b60448201526064015b60405180910390fd5b6040515f90339083908381818185875af1925050503d805f8114610183576040519150601f19603f3d011682016040523d82523d5f602084013e610188565b606091505b50509050806101cb5760405162461bcd60e51b815260206004820152600f60248201526e151c985b9cd9995c8819985a5b1959608a1b604482015260640161013b565b335f818152602081815260408083209290925590518481527f7fcf532c15f0a6db0bd6d0e038bea71d30d808c7d98cb3bf7268a95bf5081b65910160405180910390a25050565b5f34116102595760405162461bcd60e51b815260206004820152601560248201527409aeae6e840c8cae0dee6d2e840e6dedaca408aa89605b1b604482015260640161013b565b335f90815260208190526040812080543492906102779084906102e0565b909155505060405134815233907fe1fffcc4923d04b559f4d29a8bfc6cda04eb5b0d3c460751c2402c5c5cc9109c9060200160405180910390a2565b5f602082840312156102c3575f5ffd5b81356001600160a01b03811681146102d9575f5ffd5b9392505050565b808201808211156102ff57634e487b7160e01b5f52601160045260245ffd5b9291505056fea26469706673582212200dcddafa27629062a544943910575ea327a2d11111913f94dfe7921945a08ffd64736f6c634300081e0033","sourceMap":"301:1776:20:-:0;;;;;;;;;;;;;;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x608060405260043610610049575f3560e01c806327e235e31461004b5780633ccfd60b146100885780636f9fb98a1461009c578063d0e30db0146100ae578063f8b2cb4f146100b6575b005b348015610056575f5ffd5b506100766100653660046102b3565b5f6020819052908152604090205481565b60405190815260200160405180910390f35b348015610093575f5ffd5b506100496100ea565b3480156100a7575f5ffd5b5047610076565b610049610212565b3480156100c1575f5ffd5b506100766100d03660046102b3565b6001600160a01b03165f9081526020819052604090205490565b335f90815260208190526040902054806101445760405162461bcd60e51b81526020600482015260166024820152754e6f2062616c616e636520746f20776974686472617760501b60448201526064015b60405180910390fd5b6040515f90339083908381818185875af1925050503d805f8114610183576040519150601f19603f3d011682016040523d82523d5f602084013e610188565b606091505b50509050806101cb5760405162461bcd60e51b815260206004820152600f60248201526e151c985b9cd9995c8819985a5b1959608a1b604482015260640161013b565b335f818152602081815260408083209290925590518481527f7fcf532c15f0a6db0bd6d0e038bea71d30d808c7d98cb3bf7268a95bf5081b65910160405180910390a25050565b5f34116102595760405162461bcd60e51b815260206004820152601560248201527409aeae6e840c8cae0dee6d2e840e6dedaca408aa89605b1b604482015260640161013b565b335f90815260208190526040812080543492906102779084906102e0565b909155505060405134815233907fe1fffcc4923d04b559f4d29a8bfc6cda04eb5b0d3c460751c2402c5c5cc9109c9060200160405180910390a2565b5f602082840312156102c3575f5ffd5b81356001600160a01b03811681146102d9575f5ffd5b9392505050565b808201808211156102ff57634e487b7160e01b5f52601160045260245ffd5b9291505056fea26469706673582212200dcddafa27629062a544943910575ea327a2d11111913f94dfe7921945a08ffd64736f6c634300081e0033","sourceMap":"301:1776:20:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;363:43;;;;;;;;;;-1:-1:-1;363:43:20;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;451:25:22;;;439:2;424:18;363:43:20;;;;;;;991:583;;;;;;;;;;;;;:::i;1823:107::-;;;;;;;;;;-1:-1:-1;1902:21:20;1823:107;;623:188;;;:::i;1645:104::-;;;;;;;;;;-1:-1:-1;1645:104:20;;;;;:::i;:::-;-1:-1:-1;;;;;1728:14:20;1702:7;1728:14;;;;;;;;;;;;1645:104;991:583;1056:10;1030:14;1047:20;;;;;;;;;;;1085:10;1077:45;;;;-1:-1:-1;;;1077:45:20;;689:2:22;1077:45:20;;;671:21:22;728:2;708:18;;;701:30;-1:-1:-1;;;747:18:22;;;740:52;809:18;;1077:45:20;;;;;;;;;1314:34;;1296:12;;1314:10;;1337:6;;1296:12;1314:34;1296:12;1314:34;1337:6;1314:10;:34;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1295:53;;;1366:7;1358:35;;;;-1:-1:-1;;;1358:35:20;;1250:2:22;1358:35:20;;;1232:21:22;1289:2;1269:18;;;1262:30;-1:-1:-1;;;1308:18:22;;;1301:45;1363:18;;1358:35:20;1048:339:22;1358:35:20;1498:10;1512:1;1489:20;;;;;;;;;;;:24;;;;1537:30;;451:25:22;;;1537:30:20;;424:18:22;1537:30:20;;;;;;;1020:554;;991:583::o;623:188::-;689:1;677:9;:13;669:47;;;;-1:-1:-1;;;669:47:20;;1594:2:22;669:47:20;;;1576:21:22;1633:2;1613:18;;;1606:30;-1:-1:-1;;;1652:18:22;;;1645:51;1713:18;;669:47:20;1392:345:22;669:47:20;735:10;726:8;:20;;;;;;;;;;:33;;750:9;;726:8;:33;;750:9;;726:33;:::i;:::-;;;;-1:-1:-1;;774:30:20;;794:9;451:25:22;;782:10:20;;774:30;;439:2:22;424:18;774:30:20;;;;;;;623:188::o;14:286:22:-;73:6;126:2;114:9;105:7;101:23;97:32;94:52;;;142:1;139;132:12;94:52;168:23;;-1:-1:-1;;;;;220:31:22;;210:42;;200:70;;266:1;263;256:12;200:70;289:5;14:286;-1:-1:-1;;;14:286:22:o;1742:222::-;1807:9;;;1828:10;;;1825:133;;;1880:10;1875:3;1871:20;1868:1;1861:31;1915:4;1912:1;1905:15;1943:4;1940:1;1933:15;1825:133;1742:222;;;;:::o","linkReferences":{}},"methodIdentifiers":{"balances(address)":"27e235e3","deposit()":"d0e30db0","getBalance(address)":"f8b2cb4f","getContractBalance()":"6f9fb98a","withdraw()":"3ccfd60b"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.30+commit.73712a01\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"user\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"Deposit\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"user\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"Withdrawal\",\"type\":\"event\"},{\"stateMutability\":\"payable\",\"type\":\"fallback\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"name\":\"balances\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"deposit\",\"outputs\":[],\"stateMutability\":\"payable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"user\",\"type\":\"address\"}],\"name\":\"getBalance\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"getContractBalance\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"withdraw\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"stateMutability\":\"payable\",\"type\":\"receive\"}],\"devdoc\":{\"author\":\"Ricardo Silva\",\"details\":\"Este contrato cont\\u00e9m uma vulnerabilidade INTENCIONAL de reentr\\u00e2ncia para fins educacionais e testes de seguran\\u00e7a.\",\"kind\":\"dev\",\"methods\":{\"deposit()\":{\"details\":\"Permite usu\\u00e1rios depositar ETH no vault\"},\"getBalance(address)\":{\"details\":\"Retorna o balance de um usu\\u00e1rio\"},\"getContractBalance()\":{\"details\":\"Retorna o balance total do contrato\"},\"withdraw()\":{\"details\":\"Fun\\u00e7\\u00e3o vulner\\u00e1vel a reentr\\u00e2ncia! A ordem incorreta (transfer antes de atualizar o balance) permite ataques de reentr\\u00e2ncia.\"}},\"title\":\"Vault\",\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"notice\":\"N\\u00c3O USE EM PRODU\\u00c7\\u00c3O - Este contrato \\u00e9 vulner\\u00e1vel!\",\"version\":1}},\"settings\":{\"compilationTarget\":{\"src/Vault.sol\":\"Vault\"},\"evmVersion\":\"prague\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":200},\"remappings\":[\":forge-std/=lib/forge-std/src/\"]},\"sources\":{\"src/Vault.sol\":{\"keccak256\":\"0x6f479c093e67e9d1b9f530272bd0c0922efe0b458e0c44c08e89e7d8587651e2\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://acef45c42649c3739fc9b534ba72aae92e94fcb58013a74c81c963387b03750f\",\"dweb:/ipfs/Qmc8wssiKcqoDsiysUjjTAGGEmRJNfc7iRE6p1jroYhoWy\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.30+commit.73712a01"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"address","name":"user","type":"address","indexed":true},{"internalType":"uint256","name":"amount","type":"uint256","indexed":false}],"type":"event","name":"Deposit","anonymous":false},{"inputs":[{"internalType":"address","name":"user","type":"address","indexed":true},{"internalType":"uint256","name":"amount","type":"uint256","indexed":false}],"type":"event","name":"Withdrawal","anonymous":false},{"inputs":[],"stateMutability":"payable","type":"fallback"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function","name":"balances","outputs":[{"internalType":"uint256","name":"","type":"uint256"}]},{"inputs":[],"stateMutability":"payable","type":"function","name":"deposit"},{"inputs":[{"internalType":"address","name":"user","type":"address"}],"stateMutability":"view","type":"function","name":"getBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"getContractBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}]},{"inputs":[],"stateMutability":"nonpayable","type":"function","name":"withdraw"},{"inputs":[],"stateMutability":"payable","type":"receive"}],"devdoc":{"kind":"dev","methods":{"deposit()":{"details":"Permite usuários depositar ETH no vault"},"getBalance(address)":{"details":"Retorna o balance de um usuário"},"getContractBalance()":{"details":"Retorna o balance total do contrato"},"withdraw()":{"details":"Função vulnerável a reentrância! A ordem incorreta (transfer antes de atualizar o balance) permite ataques de reentrância."}},"version":1},"userdoc":{"kind":"user","methods":{},"version":1}},"settings":{"remappings":["forge-std/=lib/forge-std/src/"],"optimizer":{"enabled":true,"runs":200},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"src/Vault.sol":"Vault"},"evmVersion":"prague","libraries":{}},"sources":{"src/Vault.sol":{"keccak256":"0x6f479c093e67e9d1b9f530272bd0c0922efe0b458e0c44c08e89e7d8587651e2","urls":["bzz-raw://acef45c42649c3739fc9b534ba72aae92e94fcb58013a74c81c963387b03750f","dweb:/ipfs/Qmc8wssiKcqoDsiysUjjTAGGEmRJNfc7iRE6p1jroYhoWy"],"license":"MIT"}},"version":1},"id":20}